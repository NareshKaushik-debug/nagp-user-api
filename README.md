# ğŸ³ Kubernetes DevOps Assignment â€“ User API

This project demonstrates a complete containerized and orchestrated Node.js + MongoDB microservice running on Kubernetes. It includes persistent storage, Ingress-based routing, and self-healing capabilities via Kubernetes Deployment objects.

---

## ğŸ”— Project Links

- ğŸ“ **Code Repository:** [https://github.com/NareshKaushik-debug/nagp-user-api/tree/master](https://github.com/NareshKaushik-debug/nagp-user-api/tree/master)
- ğŸ³ **Docker Image:** [https://hub.docker.com/repository/docker/nareshkaushik36/nagp-user-api/general](https://hub.docker.com/repository/docker/nareshkaushik36/nagp-user-api/general)
- ğŸŒ **Live API Endpoint:**  
  ```
  http://34.49.15.151/api/users
  ```

---

## ğŸ“¦ Features Demonstrated

- Node.js backend exposing a REST API
- MongoDB database using Persistent Volume
- Dockerized and deployed via Kubernetes
- Ingress for routing external traffic
- Auto-recovery via pod self-healing
- End-to-end deployment validation

---

## ğŸ“½ï¸ Screen Recording (Video Demo)

ğŸ“¹ [Click here to watch the video demo](https://drive.google.com/your-video-link)

In this video:

- âœ… All Kubernetes objects are listed (Deployments, Pods, Services, PVC, etc.)
- âœ… REST API call (`GET /api/users`) is shown retrieving data from MongoDB
- âœ… API pod is killed â†’ auto-regenerated by Deployment
- âœ… MongoDB pod is killed â†’ data still persists via PVC

---

## âš™ï¸ API Endpoints

| Method | Endpoint       | Description               |
|--------|----------------|---------------------------|
| GET    | `/api/users`   | Fetch all users           |
| POST   | `/api/users`   | Add a new user            |

### Sample `POST`:
```bash
curl -X POST http://<ingress-ip>/api/users \
  -H "Content-Type: application/json" \
  -d '{"name":"TestUser", "email":"test@example.com"}'
```

---

## ğŸ§ª Testing Self-Healing

### Kill the API Pod:
```bash
kubectl delete pod -l app=user-api
```

Watch it regenerate:
```bash
kubectl get pods -l app=user-api -w
```

---

### Kill the MongoDB Pod:
```bash
kubectl delete pod -l app=mongo
```

Then check the data is still available:
```bash
curl http://<ingress-ip>/api/users
```

âœ… The old data is retained because MongoDB uses a PersistentVolume.

---

## ğŸ“ Folder Structure

```
.
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â”‚â”€â”€ manifest.yaml             # API deployment, service, ingress
â”‚â”€â”€ mongodb-manifest.yaml     # Mongo deployment + PVC
â”œâ”€â”€ models/
â”‚   â””â”€â”€ User.js
â”œâ”€â”€ server.js
â””â”€â”€ README.md
```

---

## ğŸ§  Maintained By

**Naresh Kaushik**  
[GitHub Profile](https://github.com/NareshKaushik-debug)  
[Docker Hub](https://hub.docker.com/u/nareshkaushik36)
